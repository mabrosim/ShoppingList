def protoc(String protoPath, String javaOut, String protoIn) {
    exec {
        executable "protoc"
        workingDir = "../protobuf"
        args = ["--proto_path=" + protoPath, "--java_out=" + javaOut, protoIn]
    }
}

project.afterEvaluate {
    task("protoToJava") {
        group = "Proto"
        description = "Generates Java representation from protos"

        def protoPath = "./proto";
        def javaOut = "./src/main/java";
        def protoIn = "./proto/shoppinglist.proto";

        doLast {
            try {
                protoc(protoPath, javaOut, protoIn)
                print "Java sources generated!"
            } catch (Throwable ignored) {
                print "Some problem, try in console: protoc --proto_path=./protobuf/proto --java_out=./protobuf/src/main/java ./protobuf/proto/shoppinglist.proto"
            }
        }
    }
}
